<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Enhanced Device & Tool Checkout System</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <style>
    :root {
      --primary: #3498db;
      --secondary: #2c3e50;
      --success: #27ae60;
      --warning: #f39c12;
      --danger: #e74c3c;
      --light: #ecf0f1;
      --dark: #34495e;
      --gray: #95a5a6;
      --border: #bdc3c7;
      --darker: #1a2530;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      padding: 20px;
      color: var(--dark);
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    header {
      background: linear-gradient(120deg, var(--secondary), var(--primary));
      color: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 25px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .logo i {
      font-size: 2.5rem;
      background: rgba(255, 255, 255, 0.2);
      padding: 12px;
      border-radius: 50%;
    }
    .logo h1 {
      font-size: 1.8rem;
      font-weight: 600;
    }
    .logo p {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    .controls {
      display: flex;
      gap: 10px;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .btn-primary { background: var(--primary); color: white; }
    .btn-success { background: var(--success); color: white; }
    .btn-warning { background: var(--warning); color: white; }
    .btn-danger { background: var(--danger); color: white; }
    .btn:hover { opacity: 0.9; transform: translateY(-2px); }
    .btn i { font-size: 1.1rem; }
    
    /* Dashboard styles */
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }
    .dashboard-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: transform 0.3s ease;
    }
    .dashboard-card:hover { transform: translateY(-5px); }
    .stat-icon {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--primary);
    }
    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 5px;
    }
    .stat-label {
      font-size: 1rem;
      color: var(--gray);
    }
    
    .main-content {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 25px;
      margin-bottom: 25px;
    }
    .card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      padding: 25px;
      transition: transform 0.3s ease;
    }
    .card:hover { transform: translateY(-5px); }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--light);
    }
    .card-title {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--secondary);
    }
    .form-group { margin-bottom: 20px; }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--dark);
    }
    .form-control {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 1rem;
    }
    .form-control:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .history-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    .history-table th, .history-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    .history-table th {
      background-color: var(--light);
      font-weight: 600;
      color: var(--dark);
    }
    .history-table tr:hover {
      background-color: rgba(236, 240, 241, 0.5);
    }
    .status-badge {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    .status-checked-out { background: rgba(231,76,60,0.15); color: var(--danger); }
    .status-returned { background: rgba(39,174,96,0.15); color: var(--success); }
    .action-icon {
      cursor: pointer;
      padding: 8px;
      border-radius: 5px;
      transition: background 0.2s ease;
    }
    .action-icon:hover { background: var(--light); }
    footer {
      text-align: center;
      padding: 20px;
      color: var(--gray);
      font-size: 0.9rem;
      border-top: 1px solid var(--border);
      margin-top: 30px;
    }
    
    /* Auto-suggest styles */
    .suggestions-container {
      position: relative;
    }
    .suggestions-list {
      position: absolute;
      width: 100%;
      max-height: 200px;
      overflow-y: auto;
      background: white;
      border: 1px solid var(--border);
      border-radius: 0 0 6px 6px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      z-index: 1000;
      display: none;
    }
    .suggestion-item {
      padding: 10px 15px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .suggestion-item:hover {
      background-color: var(--light);
    }
    
    /* GitHub deployment section */
    .github-section {
      background: var(--darker);
      color: white;
      border-radius: 10px;
      padding: 20px;
      margin-top: 30px;
    }
    .github-section h3 {
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .github-section ol {
      margin-left: 20px;
      margin-bottom: 15px;
    }
    .github-section li {
      margin-bottom: 8px;
    }
    .github-section code {
      background: rgba(255,255,255,0.1);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
    }
    
    @media (max-width: 900px) {
      .main-content { grid-template-columns: 1fr; }
      .form-row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <i class="fas fa-laptop-code"></i>
        <div>
          <h1>Enhanced Device & Tool Checkout System</h1>
          <p>Track all your equipment assignments in one place</p>
        </div>
      </div>
      <div class="controls">
        <button class="btn btn-success" id="exportPdfBtn"><i class="fas fa-file-pdf"></i> Export PDF</button>
        <button class="btn btn-primary" id="exportExcelBtn"><i class="fas fa-file-excel"></i> Export Excel</button>
      </div>
    </header>
    
    <!-- Dashboard Section -->
    <div class="dashboard">
      <div class="dashboard-card">
        <i class="fas fa-laptop stat-icon"></i>
        <div class="stat-value" id="totalDevicesStat">0</div>
        <div class="stat-label">Total Devices</div>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-users stat-icon"></i>
        <div class="stat-value" id="totalUsersStat">0</div>
        <div class="stat-label">Active Users</div>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-sign-out-alt stat-icon"></i>
        <div class="stat-value" id="checkoutsStat">0</div>
        <div class="stat-label">Active Checkouts</div>
      </div>
      <div class="dashboard-card">
        <i class="fas fa-history stat-icon"></i>
        <div class="stat-value" id="historyStat">0</div>
        <div class="stat-label">Total History</div>
      </div>
    </div>

    <div class="main-content">
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Checkout Equipment</h2>
          <i class="fas fa-tools"></i>
        </div>

        <div class="form-group">
          <label for="userInput">Select or Add User</label>
          <div class="suggestions-container">
            <input type="text" class="form-control" id="userInput" placeholder="Type user name" autocomplete="off"/>
            <div class="suggestions-list" id="userSuggestions"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="deviceInput">Select or Add Device</label>
          <div class="suggestions-container">
            <input type="text" class="form-control" id="deviceInput" placeholder="Type device name" autocomplete="off"/>
            <div class="suggestions-list" id="deviceSuggestions"></div>
          </div>
        </div>

        <div class="form-group">
          <label for="checkoutDate">Checkout Date</label>
          <input type="date" class="form-control" id="checkoutDate">
        </div>

        <div class="form-group">
          <label for="notes">Notes</label>
          <textarea class="form-control" id="notes" rows="3" placeholder="Additional information..."></textarea>
        </div>

        <button class="btn btn-primary" style="width: 100%;" id="checkoutBtn"><i class="fas fa-check-circle"></i> Checkout Equipment</button>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Checkout History</h2>
          <i class="fas fa-history"></i>
        </div>
        <div class="table-responsive">
          <table class="history-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Device</th>
                <th>Checkout Date</th>
                <th>Return Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="historyTableBody"></tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- GitHub Deployment Guide -->
    <div class="github-section">
      <h3><i class="fab fa-github"></i> Made By Eng: Hesham Hagag</h3>
      <ol>
        <li>Globelink"</li>
        <li>Mesco</li>
        <li>Euroshipping</li>
        <li>Saco</li>
        <li>Altun</li>
        <li>Globelink<br>
          <code> </code>
        </li>
      </ol>
      <p>Thats For Refrance.</p>
    </div>

    <footer>
      <p>Enhanced Device & Tool Checkout System v2.0 | All data stored locally in your browser |
        <a href="#" style="color: var(--primary);" id="resetData">Reset Data</a>
      </p>
    </footer>
  </div>

  <script>
    // Initialize data storage
    let checkoutHistory = JSON.parse(localStorage.getItem('checkoutHistory')) || [];
    let users = JSON.parse(localStorage.getItem('users')) || [
      "John Smith (IT Dept)", "Sarah Johnson (Design)", "Michael Brown (Engineering)", 
      "Emily Davis (Marketing)", "David Wilson (Sales)"
    ];
    let devices = JSON.parse(localStorage.getItem('devices')) || [
      "Dell XPS 15 Laptop", "MacBook Pro 16\"", "iPad Pro 12.9\"", "Samsung Galaxy Tab S8",
      "Logitech MX Master 3 Mouse", "Apple Magic Keyboard", "Wacom Intuos Pro", "Canon EOS R5 Camera"
    ];

    // DOM elements
    const historyTableBody = document.getElementById('historyTableBody');
    const checkoutBtn = document.getElementById('checkoutBtn');
    const exportPdfBtn = document.getElementById('exportPdfBtn');
    const exportExcelBtn = document.getElementById('exportExcelBtn');
    const resetDataLink = document.getElementById('resetData');
    const userInput = document.getElementById('userInput');
    const deviceInput = document.getElementById('deviceInput');
    const userSuggestions = document.getElementById('userSuggestions');
    const deviceSuggestions = document.getElementById('deviceSuggestions');
    
    // Dashboard elements
    const totalDevicesStat = document.getElementById('totalDevicesStat');
    const totalUsersStat = document.getElementById('totalUsersStat');
    const checkoutsStat = document.getElementById('checkoutsStat');
    const historyStat = document.getElementById('historyStat');

    // Helper functions
    function formatDate(date) {
      return new Date(date).toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric' 
      });
    }

    function updateDashboard() {
      // Update stats
      totalDevicesStat.textContent = devices.length;
      totalUsersStat.textContent = users.length;
      
      // Count active checkouts
      const activeCheckouts = checkoutHistory.filter(
        record => record.status === 'Checked Out'
      ).length;
      checkoutsStat.textContent = activeCheckouts;
      
      historyStat.textContent = checkoutHistory.length;
    }

    function showSuggestions(input, list, suggestions) {
      const value = input.value.toLowerCase();
      list.innerHTML = '';
      
      if (!value) {
        list.style.display = 'none';
        return;
      }
      
      const filtered = suggestions.filter(item => 
        item.toLowerCase().includes(value)
      );
      
      if (filtered.length === 0) {
        list.style.display = 'none';
        return;
      }
      
      filtered.forEach(item => {
        const div = document.createElement('div');
        div.className = 'suggestion-item';
        div.textContent = item;
        div.onclick = () => {
          input.value = item;
          list.style.display = 'none';
        };
        list.appendChild(div);
      });
      
      list.style.display = 'block';
    }

    function saveUsersDevices() {
      localStorage.setItem('users', JSON.stringify(users));
      localStorage.setItem('devices', JSON.stringify(devices));
    }

    function renderHistoryTable() {
      historyTableBody.innerHTML = '';
      
      if (checkoutHistory.length === 0) {
        historyTableBody.innerHTML = `
          <tr><td colspan="6" style="text-align:center;padding:30px;">
          <i class="fas fa-inbox" style="font-size:3rem;color:#bdc3c7;margin-bottom:15px;"></i>
          <p>No checkout history yet. Checkout a device to get started.</p></td></tr>`;
        return;
      }

      checkoutHistory.forEach((record, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${record.user}</td>
          <td>${record.device}</td>
          <td>${record.checkoutDate}</td>
          <td>${record.returnDate || '-'}</td>
          <td><span class="status-badge ${record.status === 'Checked Out' ? 'status-checked-out' : 'status-returned'}">${record.status}</span></td>
          <td>
            <i class="fas fa-edit action-icon" title="Edit" onclick="editRecord(${index})"></i>
            <i class="fas fa-undo action-icon" title="Return" onclick="returnItem(${index})"></i>
            <i class="fas fa-trash action-icon" title="Delete" onclick="deleteRecord(${index})"></i>
          </td>`;
        historyTableBody.appendChild(row);
      });
      
      updateDashboard();
    }

    function checkoutEquipment() {
      const checkoutDate = document.getElementById('checkoutDate').value;
      const notes = document.getElementById('notes').value;
      const user = userInput.value.trim();
      const device = deviceInput.value.trim();

      if (!user || !device || !checkoutDate) {
        alert('Please fill in all required fields');
        return;
      }

      // Add new user/device if they don't exist
      if (!users.includes(user)) {
        users.push(user);
      }
      
      if (!devices.includes(device)) {
        devices.push(device);
      }
      
      saveUsersDevices();

      const record = {
        id: Date.now(),
        user,
        device,
        checkoutDate: formatDate(checkoutDate),
        returnDate: null,
        status: 'Checked Out',
        notes
      };

      checkoutHistory.unshift(record);
      localStorage.setItem('checkoutHistory', JSON.stringify(checkoutHistory));
      
      // Clear inputs
      userInput.value = '';
      deviceInput.value = '';
      document.getElementById('notes').value = '';
      
      renderHistoryTable();
      alert('Equipment checked out successfully!');
    }

    function returnItem(index) {
      if (confirm('Mark this item as returned?')) {
        checkoutHistory[index].status = 'Returned';
        checkoutHistory[index].returnDate = formatDate(new Date());
        localStorage.setItem('checkoutHistory', JSON.stringify(checkoutHistory));
        renderHistoryTable();
      }
    }

    function editRecord(index) {
      const record = checkoutHistory[index];
      
      // Populate form with record data
      userInput.value = record.user;
      deviceInput.value = record.device;
      document.getElementById('checkoutDate').value = new Date(record.checkoutDate).toISOString().split('T')[0];
      document.getElementById('notes').value = record.notes || '';
      
      // Scroll to form
      document.querySelector('.card').scrollIntoView({ behavior: 'smooth' });
      
      // Update checkout button to edit mode
      checkoutBtn.innerHTML = '<i class="fas fa-save"></i> Update Record';
      checkoutBtn.onclick = function() {
        updateRecord(index);
      };
    }

    function updateRecord(index) {
      const user = userInput.value.trim();
      const device = deviceInput.value.trim();
      const checkoutDate = document.getElementById('checkoutDate').value;
      const notes = document.getElementById('notes').value;

      if (!user || !device || !checkoutDate) {
        alert('Please fill in all required fields');
        return;
      }

      checkoutHistory[index].user = user;
      checkoutHistory[index].device = device;
      checkoutHistory[index].checkoutDate = formatDate(checkoutDate);
      checkoutHistory[index].notes = notes;
      
      localStorage.setItem('checkoutHistory', JSON.stringify(checkoutHistory));
      
      // Reset form and button
      userInput.value = '';
      deviceInput.value = '';
      document.getElementById('checkoutDate').valueAsDate = new Date();
      document.getElementById('notes').value = '';
      
      checkoutBtn.innerHTML = '<i class="fas fa-check-circle"></i> Checkout Equipment';
      checkoutBtn.onclick = checkoutEquipment;
      
      renderHistoryTable();
      alert('Record updated successfully!');
    }

    function deleteRecord(index) {
      if (confirm('Are you sure you want to delete this record?')) {
        checkoutHistory.splice(index, 1);
        localStorage.setItem('checkoutHistory', JSON.stringify(checkoutHistory));
        renderHistoryTable();
      }
    }

    function exportToPDF() {
      if (checkoutHistory.length === 0) return alert('No data to export');
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(18);
      doc.text('Equipment Checkout Report', 105, 15, null, null, 'center');
      doc.setFontSize(10);
      doc.text(`Generated: ${new Date().toLocaleString()}`, 105, 22, null, null, 'center');
      
      const tableData = checkoutHistory.map(record => [
        record.user, 
        record.device, 
        record.checkoutDate,
        record.returnDate || '-',
        record.status
      ]);
      
      doc.autoTable({
        head: [['User', 'Device', 'Checkout Date', 'Return Date', 'Status']],
        body: tableData,
        startY: 30,
        styles: { fontSize: 10 },
        headStyles: { fillColor: [44, 62, 80] }
      });
      
      doc.save('equipment_checkout_report.pdf');
    }

    function exportToExcel() {
      if (checkoutHistory.length === 0) return alert('No data to export');
      
      let csv = "User,Device,Checkout Date,Return Date,Status,Notes\n";
      checkoutHistory.forEach(r => {
        csv += `"${r.user}","${r.device}","${r.checkoutDate}","${r.returnDate || ''}","${r.status}","${r.notes || ''}"\n`;
      });
      
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = "equipment_checkout_report.csv";
      a.click();
    }

    function resetData() {
      if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
        localStorage.clear();
        checkoutHistory = [];
        users = [
          "John Smith (IT Dept)", "Sarah Johnson (Design)", "Michael Brown (Engineering)", 
          "Emily Davis (Marketing)", "David Wilson (Sales)"
        ];
        devices = [
          "Dell XPS 15 Laptop", "MacBook Pro 16\"", "iPad Pro 12.9\"", "Samsung Galaxy Tab S8",
          "Logitech MX Master 3 Mouse", "Apple Magic Keyboard", "Wacom Intuos Pro", "Canon EOS R5 Camera"
        ];
        saveUsersDevices();
        renderHistoryTable();
      }
    }

    // Initialize the application
    document.addEventListener('DOMContentLoaded', function() {
      // Set current date as default
      document.getElementById('checkoutDate').valueAsDate = new Date();
      
      // Set up event listeners
      checkoutBtn.addEventListener('click', checkoutEquipment);
      exportPdfBtn.addEventListener('click', exportToPDF);
      exportExcelBtn.addEventListener('click', exportToExcel);
      resetDataLink.addEventListener('click', resetData);
      
      // Auto-suggest functionality
      userInput.addEventListener('input', () => {
        showSuggestions(userInput, userSuggestions, users);
      });
      
      deviceInput.addEventListener('input', () => {
        showSuggestions(deviceInput, deviceSuggestions, devices);
      });
      
      // Close suggestions when clicking outside
      document.addEventListener('click', (e) => {
        if (!userInput.contains(e.target)) {
          userSuggestions.style.display = 'none';
        }
        if (!deviceInput.contains(e.target)) {
          deviceSuggestions.style.display = 'none';
        }
      });
      
      // Initialize UI
      renderHistoryTable();
      updateDashboard();
      
      // Make functions available globally for onclick handlers
      window.returnItem = returnItem;
      window.deleteRecord = deleteRecord;
      window.editRecord = editRecord;
    });
  </script>
</body>
</html>